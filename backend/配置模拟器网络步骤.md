# Android模拟器网络配置详细步骤

## 问题：模拟器显示"No internet connection"

## 解决方案（按顺序尝试）

---

## 方案一：通过ADB命令配置网络（快速方法）

### 步骤1：启用WiFi

```bash
# 启用WiFi
adb shell svc wifi enable

# 等待几秒让WiFi启动
timeout /t 3
```

### 步骤2：设置DNS服务器

```bash
# 设置DNS为Google DNS
adb shell settings put global private_dns_mode off
adb shell "settings put global private_dns_specifier 8.8.8.8"

# 或者设置多个DNS
adb shell setprop net.dns1 8.8.8.8
adb shell setprop net.dns2 8.8.4.4
```

### 步骤3：重启网络服务

```bash
# 重启网络
adb shell svc wifi disable
timeout /t 2
adb shell svc wifi enable
```

### 步骤4：测试网络连接

```bash
# 测试能否ping通
adb shell ping -c 3 8.8.8.8

# 或测试能否访问网站
adb shell ping -c 3 www.baidu.com
```

---

## 方案二：在模拟器设置中配置（图形界面方法）

### 步骤1：打开模拟器设置

1. **在模拟器中打开"设置"应用**
   - 在主屏幕找到"Settings"图标（齿轮图标）
   - 或从应用抽屉中找到

### 步骤2：检查WiFi设置

1. **进入"网络和互联网"（Network & internet）**
2. **点击"Wi-Fi"**
3. **确保Wi-Fi开关是打开的**（如果是关闭的，打开它）
4. **查看连接的WiFi网络**
   - 应该显示"AndroidWifi"或类似名称
   - 点击这个网络，查看详情

### 步骤3：检查网络详情

1. **在WiFi详情页面**，查看：
   - IP地址：应该有分配（如192.168.x.x）
   - 网关：应该有值
   - DNS：如果有DNS设置，确保不是空的

### 步骤4：手动配置DNS（如果需要）

1. **在WiFi详情页面**
2. **点击"高级选项"（Advanced options）**
3. **IP设置改为"静态"（Static）**
4. **设置DNS服务器**：
   - DNS 1: `8.8.8.8`
   - DNS 2: `8.8.4.4`
5. **保存**

---

## 方案三：重启模拟器并重新配置（如果方案一、二都不行）

### 步骤1：保存当前状态（可选）

如果模拟器中有重要数据，先备份

### 步骤2：关闭模拟器

1. **关闭模拟器窗口**
2. **或在Android Studio中点击停止按钮**

### 步骤3：在AVD Manager中配置网络

1. **打开Android Studio**
2. **点击右上角的"AVD Manager"图标**（设备管理器图标）
3. **找到你的模拟器**，点击右侧的**下拉箭头** → **"Edit"（编辑）**
4. **在设置中找到"Show Advanced Settings"**，点击展开
5. **检查以下设置**：
   - **Network: Automatic**（网络：自动）
   - **Graphics: Automatic**（图形：自动）
6. **点击"Finish"保存**

### 步骤4：用特定DNS启动模拟器

1. **关闭Android Studio中的模拟器启动方式**
2. **打开命令提示符（CMD）或PowerShell**
3. **找到模拟器可执行文件路径**（通常在Android SDK目录）：
   ```
   cd C:\Users\你的用户名\AppData\Local\Android\Sdk\emulator
   ```
   （路径可能不同，可以在Android Studio的Settings → Appearance & Behavior → System Settings → Android SDK中查看）

4. **列出所有模拟器**：
   ```bash
   emulator -list-avds
   ```
   记住你的模拟器名称（例如：Medium_Phone_API_36.1）

5. **用DNS配置启动模拟器**：
   ```bash
   emulator -avd Medium_Phone_API_36.1 -dns-server 8.8.8.8,8.8.4.4
   ```
   （将模拟器名称替换为你的实际名称）

### 步骤5：测试网络

模拟器启动后：
1. 打开浏览器
2. 访问 www.baidu.com 或 www.google.com
3. 看是否能加载网页

---

## 方案四：检查Windows网络设置

### 步骤1：检查Windows防火墙

1. **打开Windows设置** → **"更新和安全"** → **"Windows安全中心"**
2. **点击"防火墙和网络保护"**
3. **确保防火墙没有阻止Android相关程序**

### 步骤2：检查网络适配器

1. **按 `Windows键 + R`**
2. **输入 `ncpa.cpl`**，按回车
3. **查看网络适配器**
4. **确保有活动的网络连接**（显示"已连接"）

### 步骤3：重启网络适配器（如果需要）

1. **在网络适配器列表中**
2. **右键点击活动的适配器** → **"禁用"**
3. **等待5秒**
4. **右键点击** → **"启用"**

---

## 快速测试网络连接的命令

打开命令提示符，依次运行：

```bash
# 1. 检查模拟器是否连接
adb devices

# 2. 检查WiFi状态
adb shell dumpsys wifi | findstr "Wi-Fi is"

# 3. 启用WiFi
adb shell svc wifi enable

# 4. 设置DNS
adb shell setprop net.dns1 8.8.8.8
adb shell setprop net.dns2 8.8.4.4

# 5. 测试网络
adb shell ping -c 3 8.8.8.8
```

---

## 推荐操作顺序

1. **先试方案一**（最快，用命令行）- 5分钟
2. **如果不行，试方案二**（图形界面）- 5分钟
3. **再不行，试方案三**（重启模拟器）- 10分钟
4. **最后检查方案四**（Windows设置）- 5分钟

---

## 验证网络是否修复

修复后，测试以下内容：

1. **在模拟器中打开浏览器**
   - 访问 `www.baidu.com` 或 `www.google.com`
   - 应该能加载网页

2. **或者运行测试命令**：
   ```bash
   adb shell ping -c 3 www.baidu.com
   ```
   - 应该能看到响应（packets received > 0）

3. **测试下载语言包**：
   - 在模拟器中打开设置 → 语言和输入法
   - 尝试下载中文语言包
   - 应该不再显示"等待下载语言包"

---

## 需要我帮你执行这些命令吗？

我可以帮你：
1. 执行ADB命令测试和配置网络
2. 检查网络连接状态
3. 找到问题所在

告诉我你想从哪个方案开始，我可以一步步帮你执行命令！


